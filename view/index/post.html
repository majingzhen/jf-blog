<?php
// view/index/post.html
View::share('title', $title ?? '');
View::share('keywords', $keywords ?? '');
View::share('description', $description ?? '');
?>

<!-- 主要内容 -->
<div class="row">
    <div class="col-md-8">
        <article class="post-card">
            <h1><?php echo htmlspecialchars($post['title']); ?></h1>
            <p class="text-muted">
                发布于 <?php echo $post['published_at_text']; ?>
                <?php if ($post->category): ?>
                    | 分类: <a href="<?php echo url('index.Index/category', ['slug' => $post->category['slug']]); ?>"><?php echo htmlspecialchars($post->category['name']); ?></a>
                <?php endif; ?>
            </p>
            <?php if ($post['summary']): ?>
                <p class="lead"><?php echo htmlspecialchars($post['summary']); ?></p>
            <?php endif; ?>
            <div class="post-content mt-3">
                <?php echo $post['content']; ?> <!-- 这里直接输出内容，如果是 Markdown 需要转换 -->
            </div>
            <div class="mt-3">
                <?php if ($post->tags && !$post->tags->isEmpty()): ?>
                    <small class="text-muted">
                        标签:
                        <?php foreach ($post->tags as $tag): ?>
                            <a href="<?php echo url('index.Index/tag', ['slug' => $tag['slug']]); ?>" class="badge bg-secondary text-decoration-none"><?php echo htmlspecialchars($tag['name']); ?></a>
                        <?php endforeach; ?>
                    </small>
                <?php endif; ?>
            </div>
        </article>
    </div>
    <div class="col-md-4">
        <!-- 侧边栏 -->
        <div class="card">
            <div class="card-header">
                <h5>分类</h5>
            </div>
            <div class="card-body">
                <?php
                $categories = \app\model\Category::select();
                foreach ($categories as $category):
                ?>
                    <div><a href="<?php echo url('index.Index/category', ['slug' => $category['slug']]); ?>"><?php echo htmlspecialchars($category['name']); ?></a></div>
                <?php endforeach; ?>
            </div>
        </div>

        <div class="card mt-3">
            <div class="card-header">
                <h5>标签</h5>
            </div>
            <div class="card-body">
                <?php
                $tags = \app\model\Tag::select();
                foreach ($tags as $tag):
                ?>
                    <a href="<?php echo url('index.Index/tag', ['slug' => $tag['slug']]); ?>" class="badge bg-light text-dark text-decoration-none m-1"><?php echo htmlspecialchars($tag['name']); ?></a>
                <?php endforeach; ?>
            </div>
        </div>
    </div>
</div>